<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <title>Gerador de Nota - Padaria NOVO PÃO</title>
  <style>
    body { font-family: Arial, sans-serif; background:#f4f4f4; padding:20px; }
    .container { max-width:900px; margin:auto; background:#fff; padding:20px; border-radius:8px; }
    h1 { text-align:center; }
    label { font-weight:bold; margin-top:10px; display:block; }
    input { width:100%; padding:8px; margin-top:5px; }
    table { width:100%; border-collapse:collapse; margin-top:20px; }
    th, td { border:1px solid #ccc; padding:6px; text-align:center; }
    button { margin-top:10px; padding:10px; cursor:pointer; }
    .totais { text-align:right; margin-top:15px; }
    .nota { border:1px dashed #333; padding:15px; margin-top:20px; }
  </style>
</head>
<body>
<div class="container">
  <h1>Nota - Padaria NOVO PÃO</h1>

  <label>Cliente</label>
  <input id="cliente">

  <label>Data do Pedido</label>
  <input type="date" id="data">

  <h3>Item</h3>
  <label>Descrição</label>
  <input id="descricao">

  <label>Quantidade</label>
  <input type="number" id="quantidade">

  <label>Valor Unitário</label>
  <input type="number" step="0.01" id="valor">

  <button onclick="adicionarItem()">Adicionar Pedido</button>

  <table>
    <thead>
      <tr>
        <th>Data</th>
        <th>Descrição</th>
        <th>Qtd</th>
        <th>Unitário</th>
        <th>Total</th>
      </tr>
    </thead>
    <tbody id="itens"></tbody>
  </table>

  <div class="totais">
    <strong>Total: R$ <span id="total">0.00</span></strong>
  </div>

  <button onclick="gerarNota()">Gerar Nota</button>
  <button onclick="baixarPDF()">Baixar PDF</button>

  <div class="nota" id="nota"></div>
</div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
<script>
let itens = [];

function adicionarItem(){
  const desc = descricao.value;
  const qtd = Number(quantidade.value);
  const val = Number(valor.value);
  const data = document.getElementById('data').value;
  if(!desc || qtd<=0 || val<=0 || !data) return;

  itens.push({
    data: data.split('-').reverse().join('/'),
    desc,
    qtd,
    val,
    total: qtd * val
  });
  render();
}

function render(){
  const tbody = document.getElementById('itens');
  tbody.innerHTML='';
  let total=0;

  itens.forEach(i=>{
    total+=i.total;
    tbody.innerHTML+=`<tr>
      <td>${i.data}</td>
      <td>${i.desc}</td>
      <td>${i.qtd}</td>
      <td>R$ ${i.val.toFixed(2)}</td>
      <td>R$ ${i.total.toFixed(2)}</td>
    </tr>`;
  });

  document.getElementById('total').innerText=total.toFixed(2);
}

function gerarNota(){
  const cliente = document.getElementById('cliente').value;
  let texto = `<strong>${cliente}</strong><br><br>`;

  itens.forEach(i=>{
    texto+=`${i.data} ${i.qtd} (${i.desc}) R$ ${i.val.toFixed(2)} = R$ ${i.total.toFixed(2)}<br>`;
  });

  texto+=`<br><strong>Total: R$ ${document.getElementById('total').innerText}</strong>`;
  document.getElementById('nota').innerHTML = texto;
}

function baixarPDF(){
  const { jsPDF } = window.jspdf;
  const pdf = new jsPDF();
  let y=10;
  const cliente = document.getElementById('cliente').value;

  pdf.text(cliente,10,y); y+=8;

  itens.forEach(i=>{
    pdf.text(`${i.data} ${i.qtd} (${i.desc}) ${i.val.toFixed(2)} = ${i.total.toFixed(2)}`,10,y);
    y+=6;
  });

  pdf.text(`Total: R$ ${document.getElementById('total').innerText}`,10,y+6);
  pdf.save(`nota-${cliente}.pdf`);
}
</script>
</body>
</html>
